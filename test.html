<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />

  <link rel="stylesheet" type="text/css" href="/templates/pandoc-bootstrap-template/template.css" />
  <script src="/templates/pandoc-bootstrap-template/script.js"></script>
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Dennis Iversen" />
  <title>Test book</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</head>
<body data-spy="scroll" data-target=".navbar-collapse">

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">Test book</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Dennis Iversen</p></li>
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">
        <ul>
          <li class="nav-header">Table of Contents</li>
        </ul>
        <ul>
        <li><a href="#git-to-book-docs"><span class="toc-section-number">1</span> Git to book docs</a><ul>
        <li><a href="#pandoc-config-meta.yaml"><span class="toc-section-number">1.1</span> Pandoc config / meta.yaml</a></li>
        <li><a href="#pandoc-options"><span class="toc-section-number">1.2</span> Pandoc options</a></li>
        <li><a href="#fonts"><span class="toc-section-number">1.3</span> Fonts</a></li>
        <li><a href="#useful-resources"><span class="toc-section-number">1.4</span> Useful Resources</a></li>
        <li><a href="#install-local"><span class="toc-section-number">1.5</span> Install local</a></li>
        <li><a href="#requirements"><span class="toc-section-number">1.6</span> Requirements:</a></li>
        <li><a href="#build"><span class="toc-section-number">1.7</span> Build</a></li>
        <li><a href="#system-config"><span class="toc-section-number">1.8</span> System config</a></li>
        </ul></li>
        </ul>
        </div>
      </div>
            <div class="span9">
            <h1 id="git-to-book-docs"><span class="header-section-number">1</span> Git to book docs</h1>
<hr />
<div class="wrapper">
<div class="videocontent">
<video id="really-cool-video" class="video-js vjs-default-skin" controls preload="auto" width="auto" height="auto" data-setup="{}">
<source type="video/mp4" src="/files/default/video/content/article/5/5653375f99358.mp4"><br />
 <source type="video/flv" src="/files/default/video/content/article/5/5653375f99358.flv"> <source type="video/webm" src="/files/default/video/content/article/5/5653375f99358.webm">
<p class="vjs-no-js">
<pre><code>To view this video please enable JavaScript, and consider upgrading to a web browser
that &lt;a href=&quot;http://videojs.com/html5-video-support/&quot; target=&quot;_blank&quot;&gt;supports HTML5 video&lt;/a&gt;</code></pre>
</p>
</video>
</div>
</div>
<hr />
<p><strong>Gittobook</strong> (git-to-book) is an easy way to write to multiple formats using markdown. It transforms a git repository containing markdown files into Epub, Mobi, and PDF. These formats are often formats used to create books - online ebooks or for books for print.</p>
<p>It is basically a bridge between <strong>pandoc</strong> (<a href="http://pandoc.org" class="uri">http://pandoc.org</a>) and <strong>git</strong>. Pandoc is used to generate the different output formats, and git repositories are used to store the written markdown files, and assets, such as templates, CSS, fonts, and images. The aim is to enable people to use git when writing large text documents, which has to be transformed into different formats.</p>
<p>There is a online version, which you can log into. This can be found on <a href="http://gittobook.org" class="uri">http://gittobook.org</a>. The online version will export to Epub, Mobi, PDF and HTML, but with some restrictions in templates and options.</p>
<p>When you add a new git repo URL to the system, gittobook will checkout the repo, and look for any markdown files (<code>.md</code>). It will always checkout the <code>default</code> branch - this is often <code>master</code>, but does not have to be. The markdown files found are then collected into one document, which is transformed using pandoc.</p>
<p>You can browse this documentation on the github.com repository location (<a href="https://github.com/diversen/git-to-book-docs" class="uri">https://github.com/diversen/git-to-book-docs</a>) or on the gittobook.org website location (<a href="http://gittobook.org/books/47/git-to-book-docs" class="uri">http://gittobook.org/books/47/git-to-book-docs</a>). This is the repo used to generate the git-to-book-docs. You can also fork it and suggest edits. This document is just a simple <code>README.md</code>.</p>
<p>If you work on a larger book you can just add some directories to keep you content better organised. The file structure is parsed so that any directories are first examined for markdown files, which should end on the <code>.md</code> extension. The way a directory is listed resembles the way <a href="http://github.com" class="uri">http://github.com</a> displays files, when looking at a repository online. This means directories are displayed first, and then files. In order to keep you files in the right order you can add e.g. <code>01-</code>, <code>02-</code> etc. in front of directories and documents, as this will give you the sorting you want.</p>
<h2 id="pandoc-config-meta.yaml"><span class="header-section-number">1.1</span> Pandoc config / meta.yaml</h2>
<p>The gittobook will prepend a <code>meta.yaml</code> file if one is found (for adding meta data to the document - such as author, title, cover-image, build commands, etc). In the <code>meta.yaml</code> you can (and should) specify title, author, and other meta info used with pandoc. This is quite a simple <code>meta.yaml</code>.</p>
<pre class="yaml---"><code>title: &#39;Git to book documentation&#39;
Subtitle: &gt; 
    A simple way to generate 
    PDF, EPUB, MOBI, HTML, 
    using Markdown and git repositories. 
    Output formats are generated using Pandoc.
subject: Gittobook documentation
author:
- Dennis Bæk Iversen
keywords: ebooks, pandoc, pdf, html
rights: Creative Commons Non-Commercial Share Alike 3.0
language: en-US
lang: en
cover-image: images/cover.jpg
tags: [pandoc, pdf, epub, mobi creation]
...</code></pre>
<p>If there is not found any meta.yaml, then the books will be built with some default options. Title becomes <code>Unknown</code> and author becomes <code>John Doe</code>. If there is no <code>cover-image</code> (for Epubs and Mobi files), then the system will generate a default cover image.</p>
<p>You can also specify build commands used, when pandoc executes the command. You can see an example here: <a href="https://github.com/diversen/git-to-book-docs/blob/master/meta.yaml" class="uri">https://github.com/diversen/git-to-book-docs/blob/master/meta.yaml</a>. You will see that the <code>format-arguments</code> are specific to gittobook, otherwise it is a standard pandoc <code>.yaml file</code>. The <code>format-arguments</code> are the command line options given to pandoc. You can also add files to <code>ignore-files</code>, e.g. <code>README.md</code>.</p>
<p>If there is no <code>format-arguments</code> then some default <code>format-arguments</code> will be used.</p>
<h2 id="pandoc-options"><span class="header-section-number">1.2</span> Pandoc options</h2>
<p>The following pandoc options are allowed in the online version. If you build the software youself all options are allowed. Note: These descriptions are taken from pandoc documentation.</p>
<p>Produce typographically correct output, converting straight quotes to curly quotes:</p>
<pre><code>-S
--smart</code></pre>
<p>Specify the base level for headers (defaults to 1)</p>
<pre><code>--base-header-level=[1-6]</code></pre>
<p>Produce output with an appropriate header and footer.</p>
<pre><code>-s
--standalone</code></pre>
<p>Include an automatically generated table of contents</p>
<pre><code>--toc</code></pre>
<p>Specify the number of section levels to include in the table of contents. The default is 3</p>
<pre><code>--toc-depth=[1-6]</code></pre>
<p>Syntax highlight filter: Options are pygments (the default), kate, monochrome, espresso, zenburn, haddock, and tango.</p>
<pre><code>--highlight-style=[string]</code></pre>
<p>Produce a standalone HTML file with no external dependencies, images and css will be embeded.</p>
<pre><code>--self-contained</code></pre>
<p>Produce HTML5 instead of HTML4.</p>
<pre><code>--html5</code></pre>
<p>Treat top-level headers as chapters in LaTeX, ConTeXt, and DocBook output.</p>
<pre><code>--chapters</code></pre>
<p>Number section headings in LaTeX, ConTeXt, HTML, or EPUB output.</p>
<pre><code>-N
--number-sections</code></pre>
<p>Use the specified CSS file to style the EPUB</p>
<pre><code>--epub-stylesheet</code></pre>
<p>Headers level in epub files.</p>
<pre><code>--epub-chapter-level=[1-6]</code></pre>
<p>Embed a epub font</p>
<pre><code>--epub-embed-font=[path/to/font]</code></pre>
<p>Pandoc variables.</p>
<pre><code>-V=variable </code></pre>
<p>Allowed subset of variables:</p>
<pre><code>geometry:margin
documentclass
lang</code></pre>
<p>Vairable example:</p>
<pre><code>-V sansfont=Arial -V fontsize=12pt -V version=1.10</code></pre>
<h2 id="fonts"><span class="header-section-number">1.3</span> Fonts</h2>
<p>When using pandoc for transformation of e.g. chinese you will need to change your font in order to get a readable result. Here are a list of fonts on the server. If you install local you will usually be able to get a font list with the command <code>fc-list</code>.</p>
<p>This is the fonts on the server:</p>
<p><a href="https://github.com/diversen/git-to-book-docs/blob/master/font-list" class="uri">https://github.com/diversen/git-to-book-docs/blob/master/font-list</a></p>
<p>In order to use e.g. chinese you will se that a chinese font exists: <code>WenQuanYi Micro Hei Mono</code> is the font name. Found on line 529.</p>
<p>In your meta tag you should add something like the following.</p>
<pre><code>format-arguments:
    pdf: &gt; 
        -V mainfont=&#39;WenQuanYi Micro Hei Mono&#39; 
        -V sansfont=&#39;WenQuanYi Micro Hei Mono&#39; 
        -V monofont=&#39;WenQuanYi Micro Hei Mono&#39;</code></pre>
<h2 id="useful-resources"><span class="header-section-number">1.4</span> Useful Resources</h2>
<p>Template variables</p>
<p><a href="http://johnmacfarlane.net/pandoc/README.html#templates" class="uri">http://johnmacfarlane.net/pandoc/README.html#templates</a></p>
<p>The pandoc markdown.</p>
<p><a href="http://johnmacfarlane.net/pandoc/demo/example9/pandocs-markdown.html" class="uri">http://johnmacfarlane.net/pandoc/demo/example9/pandocs-markdown.html</a></p>
<p>Math LaTex:</p>
<p><a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics" class="uri">http://en.wikibooks.org/wiki/LaTeX/Mathematics</a></p>
<p>This:</p>
<pre><code>$$
\Gamma(z) = \int_0^\infty t^{z-1}e^{-t}dt\,.
$$</code></pre>
<p>renders:</p>
<p><br /><span class="math display"><em>Γ</em>(<em>z</em>)=∫<sub>0</sub><sup>∞</sup><em>t</em><sup><em>z</em> − 1</sup><em>e</em><sup>−<em>t</em></sup><em>d</em><em>t</em> .</span><br /></p>
<p>Some other Pandoc templates:</p>
<p><a href="https://github.com/jgm/pandoc/wiki/User-contributed-templates" class="uri">https://github.com/jgm/pandoc/wiki/User-contributed-templates</a></p>
<h2 id="install-local"><span class="header-section-number">1.5</span> Install local</h2>
<h2 id="requirements"><span class="header-section-number">1.6</span> Requirements:</h2>
<ul>
<li>Apache2</li>
<li>php5 &gt;= 5.3</li>
<li>mysql-server</li>
<li>pandoc</li>
<li>texlive-full (for PDF support)</li>
<li>kindlegen (for Mobi support)</li>
</ul>
<h2 id="build"><span class="header-section-number">1.7</span> Build</h2>
<p>First clone the base system into e.g. yoursite:</p>
<pre><code>git clone https://github.com/diversen/php-git-to-book example.com</code></pre>
<p>Enter the base system:</p>
<pre><code>cd yoursite</code></pre>
<p>Install dependencies. May take some time:</p>
<pre><code>composer update</code></pre>
<p>Enable apache2 host:</p>
<pre><code>// you will need to be root
sudo ./coscli.sh apache2 --en example.com</code></pre>
<p>Run install command:</p>
<pre><code>./coscli.sh prompt-install --install</code></pre>
<p>You will be asked about DB configuration, and version to install. Use a <code>tag</code> or <code>master</code>. After writing the <code>config/config.ini</code> file the system will install all the profile modules from git repos. At last the system will prompt you for a super user. Enter an email and password</p>
<p>Set correct perms for public files after install (e.g. upload folder)</p>
<pre><code>// you will need to be root user as we change
// the perms to be www-data
sudo ./coscli.sh file --chmod-files</code></pre>
<p>We use a extra public directory, which you will need to add manual:</p>
<pre><code>mkdir htdocs/books</code></pre>
<p>Set correct ownership:</p>
<pre><code>sudo chown www-data:www-data htdocs/books</code></pre>
<p>Go to http://example.com and log in and add a repo.</p>
<h2 id="system-config"><span class="header-section-number">1.8</span> System config</h2>
<p>If you make the above install, then the system is multi user by default. But you can make a few configuration changes in order to change this. This shows the default <code>gitbook.ini</code> file which is located in <code>modules/gitbook</code>.</p>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="co">; who can use it</span>
<span class="co">; user is a user which has signed up - </span>
<span class="co">; admin is created in the install proces</span>
<span class="dt">gitbook_allow </span><span class="ot">=</span><span class="st"> &#39;user&#39;</span>
<span class="co">; who is allowed to use the all options in meta.yaml</span>
<span class="co">; insert unescaped inline HTML for e.g. videos</span>
<span class="dt">gitbook_allow_ext </span><span class="ot">=</span><span class="st"> &#39;admin&#39;</span>
<span class="co">; for &#39;gitbook_allow&#39; only these formats works</span>
<span class="dt">gitbook_exports </span><span class="ot">=</span><span class="st"> &#39;epub,html,pdf&#39;</span>
<span class="co">; assets allowed for &#39;gitbook_allow&#39;</span>
<span class="dt">gitbook_allow_assets </span><span class="ot">=</span><span class="st"> &#39;css,jpeg,jpg,png,gif&#39;</span></code></pre></div>
            </div>
    </div>
  </div>

</body>
</html>
